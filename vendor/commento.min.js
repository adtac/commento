!function(t,e){"use strict";function n(t){return e.getElementById(t)}function o(t,e){t.appendChild(e)}function r(t,e){t.classList.add(e)}function a(t,e){t.classList.remove(e)}function i(t){return e.createElement(t)}function d(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")}function s(t,e,n){t.setAttribute(e,n)}function c(t,e,n){var o=new XMLHttpRequest;o.open("POST",t,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){4===o.readyState&&200===o.status&&n(o)},o.send(d(e))}function l(t,n){var r=e.createElement("script"),a=!1;r.type="application/javascript",r.src=t,r.async=!0,r.onreadystatechange=r.onload=function(){a||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||n(),a=!0,r.onload=r.onreadystatechange=null},o(e.body,r)}function m(t){var n=e.createElement("link"),r=e.getElementsByTagName("head")[0];n.type="text/css",n.setAttribute("href",t),n.setAttribute("rel","stylesheet"),o(r,n)}function u(t,e){var n=6e4,o=36e5,r=864e5,a=2592e6,i=94608e7,d=t-e;return n>d?Math.round(d/1e3)+" seconds ago":o>d?Math.round(d/n)+" minutes ago":r>d?Math.round(d/o)+" hours ago":a>d?"approximately "+Math.round(d/r)+" days ago":i>d?"approximately "+Math.round(d/a)+" months ago":"approximately "+Math.round(d/i)+" years ago"}var p,h="https://cdn.rawgit.com/showdownjs/showdown/1.6.3/dist/showdown.min.js",v="https://cdn.rawgit.com/picturepan2/spectre/master/docs/dist/spectre.min.css",y="https://cdn.rawgit.com/adtac/commento/0.0.2/vendor/commento.min.css",f="",b={},_=[],g=t.Commento||{};g.version="0.0.4";var w=function(){var t={url:e.location};c(b.get,t,function(t){var e=JSON.parse(t.response);_=e.comments,x()})},C=function(t,e){var n=t[e];if(!n||!n.length)return null;var o=i("div");return n.forEach(function(e){var n=i("div"),a=i("div"),d=i("h5"),c=i("div"),l=i("div"),m=i("div"),h=i("button"),v=C(t,e.id);r(n,"card"),r(a,"card-header"),d.innerHTML=e.name,c.innerHTML=u(Date.now(),Date.parse(e.timestamp)),r(c,"card-subtitle"),s(c,"style","margin-left: 15px;"),l.id="body_"+e.id,l.innerHTML=p.makeHtml(e.comment),r(l,"card-body"),r(m,"card-header"),h.id="reply_button_"+e.id,h.innerHTML="Reply",r(h,"btn"),s(h,"onclick","Commento.showReply("+e.id+")"),m.appendChild(h),a.appendChild(d),a.appendChild(c),n.appendChild(a),n.appendChild(l),n.appendChild(m),v&&(v.classList.add("card-body"),n.appendChild(v)),o.appendChild(n)}),o},x=function(){var t,e=n("coms"),r={};e.innerHTML="",_.forEach(function(e){t=e.parent,t in r||(r[t]=[]),r[t].push(e)});var a=C(r,-1);a&&o(e,a)};g.postRoot=function(){var t,o=n("root_comment"),i=n("root_name"),d=o.value,s=i.value;return a(o,"is-error"),a(i,"is-error"),d&&d.length?s&&s.length?(t={url:e.location,comment:o.value,name:i.value,parent:-1},void c(b.create,t,function(){o.value="",w()})):void r(i,"is-error"):void r(o,"is-error")},g.submitReply=function(t){var o=n("reply_textarea_"+t),i=n("name_input_"+t),d=o.value,s=i.value;if(a(o,"is-error"),a(i,"is-error"),!d.length)return void r(o,"is-error");if(!s.length)return void i.classList.add("is-error");var l={comment:d,name:s,parent:t,url:e.location};c(b.create,l,w)},g.cancelReply=function(t){n("reply_textarea_"+t).remove(),n("submit_button_"+t).remove(),n("cancel_button_"+t).remove(),n("name_input_"+t).remove(),n("reply_button_"+t).setAttribute("style","display: initial")},g.showReply=function(t){s(n("reply_button_"+t),"style","display: none");var e=n("body_"+t),a=i("textarea"),d=i("input"),c=i("button"),l=i("button"),m=i("div");a.id="reply_textarea_"+t,r(a,"form-input"),o(e,a),r(d,"form-input"),d.id="name_input_"+t,s(d,"placeholder","Name"),s(d,"style","margin: 1px; width: 33%;"),c.id="cancel_button_"+t,c.innerHTML="Cancel",r(c,"btn"),s(c,"onclick","Commento.cancelReply("+t+")"),s(c,"style","margin: 1px; width: 33%;"),l.id="submit_button_"+t,l.innerHTML="Reply",r(l,"btn"),r(l,"btn-primary"),s(l,"onclick","Commento.submitReply("+t+")"),s(l,"style","margin: 1px; width: 33%;"),r(m,"button-holder"),o(m,d),o(m,c),o(m,l),s(m,"style","display: flex; width: 100%; margin: 2px;"),o(e,m)},g.init=function(t){f=t.serverUrl||f,h=t.showdownUrl||h,v=t.spectreUrl||v,y=t.commentoCssUrl||y,b.get=f+"/get",b.create=f+"/create",m(v),m(y),l(h,function(){p=new showdown.Converter;var t=n("commento"),e=i("div"),a=i("textarea"),d=i("div"),s=i("input"),c=i("button"),l=i("div");r(e,"commento-comments"),a.setAttribute("id","root_comment"),r(a,"form-input"),r(d,"submit_area"),r(s,"form-input"),r(s,"root-elem"),s.id="root_name",s.setAttribute("placeholder","Name"),c.innerHTML="Post comment",r(c,"root-elem"),r(c,"btn"),r(c,"btn-primary"),c.setAttribute("onclick","Commento.postRoot()"),l.id="coms",o(d,s),o(d,c),o(e,a),o(e,d),o(e,l),o(t,e),w()})},t.Commento=g}(window,document);